import { ref } from 'vue';
import { emit as emitFigma } from '@create-figma-plugin/utilities';

function useComponents() {
  const components = ref([]);

  function getComponents() {
    figma.ui.postMessage('GET_COMPONENTS');
  }

  function createComponent() {
    emitFigma('CREATE_COMPONENT', {
      name: 'New component',
      x: 67,
      y: 81,
      width: 76,
      height: 27,

      layoutPositioning: 'AUTO',
      children: [
        {
          type: 'TEXT',
          name: 'Button',
          fills: [
            {
              type: 'SOLID',
              visible: true,
              opacity: 1,
              blendMode: 'NORMAL',
              color: {
                r: 1,
                g: 1,
                b: 1
              },
              boundVariables: {
                color: {
                  type: 'VARIABLE_ALIAS',
                  id: 'VariableID:70:88506'
                }
              }
            }
          ],
          fillGeometry: [
            {
              windingRule: 'NONZERO',
              data: 'M1.31996 15 L1.31996 5.54545 L4.78232 5.54545 C5.45324 5.54545 6.00876 5.65625 6.44886 5.87784 C6.88897 6.09635 7.21828 6.39335 7.43679 6.76882 C7.6553 7.14122 7.76456 7.56132 7.76456 8.02912 C7.76456 8.42306 7.69224 8.75544 7.54759 9.02628 C7.40294 9.29403 7.20904 9.50947 6.96591 9.67258 C6.72585 9.83262 6.46117 9.94957 6.17188 10.0234 L6.17188 10.1158 C6.4858 10.1312 6.79202 10.2327 7.09055 10.4205 C7.39216 10.6051 7.64145 10.8683 7.83842 11.2099 C8.03539 11.5515 8.13388 11.967 8.13388 12.4563 C8.13388 12.9395 8.02001 13.3735 7.79226 13.7582 C7.56759 14.1398 7.21982 14.4429 6.74893 14.6676 C6.27805 14.8892 5.67637 15 4.94389 15 L1.31996 15 Z M2.74645 13.7766 L4.8054 13.7766 C5.48864 13.7766 5.97798 13.6443 6.27344 13.3796 C6.56889 13.1149 6.71662 12.7841 6.71662 12.3871 C6.71662 12.0885 6.64122 11.8146 6.49041 11.5653 C6.33961 11.3161 6.12417 11.1175 5.84411 10.9698 C5.56712 10.8221 5.23781 10.7482 4.85618 10.7482 L2.74645 10.7482 L2.74645 13.7766 Z M2.74645 9.63565 L4.65767 9.63565 C4.97775 9.63565 5.26551 9.5741 5.52095 9.45099 C5.77947 9.32789 5.98414 9.15554 6.13494 8.93395 C6.28883 8.70928 6.36577 8.4446 6.36577 8.13991 C6.36577 7.74905 6.22881 7.42128 5.9549 7.15661 C5.68099 6.89193 5.26089 6.75959 4.6946 6.75959 L2.74645 6.75959 L2.74645 9.63565 Z M14.2069 12.0593 L14.2069 7.90909 L15.5918 7.90909 L15.5918 15 L14.2346 15 L14.2346 13.772 L14.1607 13.772 C13.9976 14.1506 13.736 14.466 13.3759 14.7184 C13.0189 14.9677 12.5742 15.0923 12.0417 15.0923 C11.5862 15.0923 11.1831 14.9923 10.8322 14.7923 C10.4844 14.5891 10.2105 14.2891 10.0105 13.892 C9.81351 13.495 9.71502 13.0041 9.71502 12.4194 L9.71502 7.90909 L11.0953 7.90909 L11.0953 12.2532 C11.0953 12.7364 11.2292 13.1211 11.497 13.4073 C11.7647 13.6935 12.1125 13.8366 12.5403 13.8366 C12.7988 13.8366 13.0558 13.772 13.3113 13.6428 C13.5698 13.5135 13.7837 13.3181 13.9529 13.0565 C14.1253 12.7949 14.2099 12.4625 14.2069 12.0593 Z M20.7565 7.90909 L20.7565 9.01705 L16.8833 9.01705 L16.8833 7.90909 L20.7565 7.90909 Z M17.922 6.21023 L19.3023 6.21023 L19.3023 12.918 C19.3023 13.1857 19.3423 13.3873 19.4223 13.5227 C19.5023 13.6551 19.6054 13.7459 19.7316 13.7951 C19.8609 13.8413 20.0009 13.8643 20.1517 13.8643 C20.2625 13.8643 20.3595 13.8567 20.4426 13.8413 C20.5257 13.8259 20.5903 13.8136 20.6365 13.8043 L20.8857 14.9446 C20.8057 14.9754 20.6919 15.0062 20.5441 15.0369 C20.3964 15.0708 20.2117 15.0893 19.9901 15.0923 C19.627 15.0985 19.2884 15.0339 18.9745 14.8984 C18.6606 14.763 18.4067 14.5537 18.2128 14.2706 C18.0189 13.9875 17.922 13.632 17.922 13.2042 L17.922 6.21023 Z M25.5934 7.90909 L25.5934 9.01705 L21.7202 9.01705 L21.7202 7.90909 L25.5934 7.90909 Z M22.7589 6.21023 L24.1392 6.21023 L24.1392 12.918 C24.1392 13.1857 24.1792 13.3873 24.2592 13.5227 C24.3393 13.6551 24.4424 13.7459 24.5685 13.7951 C24.6978 13.8413 24.8378 13.8643 24.9886 13.8643 C25.0994 13.8643 25.1964 13.8567 25.2795 13.8413 C25.3626 13.8259 25.4272 13.8136 25.4734 13.8043 L25.7227 14.9446 C25.6426 14.9754 25.5288 15.0062 25.381 15.0369 C25.2333 15.0708 25.0487 15.0893 24.8271 15.0923 C24.4639 15.0985 24.1254 15.0339 23.8114 14.8984 C23.4975 14.763 23.2436 14.5537 23.0497 14.2706 C22.8558 13.9875 22.7589 13.632 22.7589 13.2042 L22.7589 6.21023 Z M30.031 15.1431 C29.3662 15.1431 28.7861 14.9908 28.2906 14.6861 C27.7951 14.3814 27.4104 13.9551 27.1365 13.4073 C26.8625 12.8595 26.7256 12.2193 26.7256 11.4869 C26.7256 10.7513 26.8625 10.1081 27.1365 9.55717 C27.4104 9.00627 27.7951 8.57848 28.2906 8.27379 C28.7861 7.96911 29.3662 7.81676 30.031 7.81676 C30.6958 7.81676 31.2759 7.96911 31.7714 8.27379 C32.2669 8.57848 32.6516 9.00627 32.9255 9.55717 C33.1994 10.1081 33.3364 10.7513 33.3364 11.4869 C33.3364 12.2193 33.1994 12.8595 32.9255 13.4073 C32.6516 13.9551 32.2669 14.3814 31.7714 14.6861 C31.2759 14.9908 30.6958 15.1431 30.031 15.1431 Z M30.0356 13.9844 C30.4665 13.9844 30.8235 13.8705 31.1066 13.6428 C31.3898 13.415 31.599 13.1119 31.7345 12.7333 C31.873 12.3548 31.9422 11.9377 31.9422 11.4822 C31.9422 11.0298 31.873 10.6143 31.7345 10.2358 C31.599 9.85417 31.3898 9.54794 31.1066 9.31712 C30.8235 9.08629 30.4665 8.97088 30.0356 8.97088 C29.6017 8.97088 29.2416 9.08629 28.9553 9.31712 C28.6722 9.54794 28.4614 9.85417 28.3229 10.2358 C28.1875 10.6143 28.1198 11.0298 28.1198 11.4822 C28.1198 11.9377 28.1875 12.3548 28.3229 12.7333 C28.4614 13.1119 28.6722 13.415 28.9553 13.6428 C29.2416 13.8705 29.6017 13.9844 30.0356 13.9844 Z M36.2575 10.7898 L36.2575 15 L34.8771 15 L34.8771 7.90909 L36.2021 7.90909 L36.2021 9.06321 L36.2898 9.06321 C36.4529 8.68774 36.7083 8.38613 37.0561 8.15838 C37.407 7.93063 37.8486 7.81676 38.381 7.81676 C38.8642 7.81676 39.2874 7.91832 39.6506 8.12145 C40.0137 8.3215 40.2953 8.62003 40.4954 9.01705 C40.6954 9.41406 40.7955 9.90495 40.7955 10.4897 L40.7955 15 L39.4151 15 L39.4151 10.6559 C39.4151 10.1419 39.2812 9.74029 39.0135 9.45099 C38.7457 9.15862 38.378 9.01243 37.9102 9.01243 C37.5901 9.01243 37.3054 9.08168 37.0561 9.22017 C36.8099 9.35866 36.6145 9.56179 36.4698 9.82955 C36.3282 10.0942 36.2575 10.4143 36.2575 10.7898 Z'
            }
          ],
          strokeGeometry: [],
          relativeTransform: [
            [
              1,
              0,
              17
            ],
            [
              0,
              1,
              3
            ]
          ],
          absoluteTransform: [
            [
              1,
              0,
              -609
            ],
            [
              0,
              1,
              -475
            ]
          ],
          x: 17,
          y: 3,
          width: 42,
          height: 20,
          absoluteBoundingBox: {
            x: -609,
            y: -475,
            width: 42,
            height: 20
          },
          absoluteRenderBounds: {
            x: -607.6800537109375,
            y: -469.4545593261719,
            width: 39.47552490234375,
            height: 9.59765625
          },
          rotation: 0,
          layoutAlign: 'INHERIT',
          constrainProportions: false,
          layoutGrow: 0,
          layoutPositioning: 'AUTO',
          minWidth: null,
          minHeight: null,
          maxWidth: null,
          maxHeight: null,
          layoutSizingHorizontal: 'FIXED',
          layoutSizingVertical: 'FIXED',
          exportSettings: [],
          constraints: {
            horizontal: 'SCALE',
            vertical: 'SCALE'
          },
          characters: 'Button',
          hasMissingFont: false,
          fontSize: 13,
          hangingPunctuation: false,
          hangingList: false,
          paragraphIndent: 0,
          paragraphSpacing: 8,
          listSpacing: 0,
          textCase: 'ORIGINAL',
          textDecoration: 'NONE',
          letterSpacing: {
            unit: 'PERCENT',
            value: 0
          },
          lineHeight: {
            unit: 'PIXELS',
            value: 20
          },
          leadingTrim: 'NONE',
          fontName: {
            family: 'Inter',
            style: 'Medium'
          },
          fontWeight: 500,
          openTypeFeatures: {},
          hyperlink: null,
          canUpgradeToNativeBidiSupport: false,
          autoRename: true,
          textAlignHorizontal: 'CENTER',
          textAlignVertical: 'TOP',
          textAutoResize: 'WIDTH_AND_HEIGHT',
          textStyleId: 'S:1e534f052e0014e0d252a6f42e2cc009af9d8c5a,532:1',
          textTruncation: 'DISABLED',
          maxLines: null,
          reactions: [],
          playbackSettings: {
            autoplay: true,
            loop: true,
            muted: false
          },
        }
      ]
    });
  }

  return {
    components,
    getComponents,
    createComponent
  };
}

export default useComponents;
